<!--
  Copyright (c) 2017 Bonnie Schulkin. All Rights Reserved.

  This file is part of BoxCharter.

  BoxCharter is free software: you can redistribute it and/or modify it under
  the terms of the GNU Affero General Public License as published by the Free
  Software Foundation, either version 3 of the License, or (at your option)
  any later version.

  BoxCharter is distributed in the hope that it will be useful, but WITHOUT
  ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero General Public License
  for more details.

  You should have received a copy of the GNU Affero General Public License
  along with BoxCharter. If not, see <http://www.gnu.org/licenses/>.
-->

<div *ngIf="chart">
  <h1>{{ chart.metaData.title }}</h1>

  <div *ngFor="let section of chart.sections">
    <!-- sections -->
    <h2>{{ section.metaData.name }}</h2>
    <h5>{{ section.metaData.description }}</h5>
    <table class="table table-compact">
      <!-- measures -->
      <tr *ngFor="let i of section.rows | fill">
        <ng-container *ngIf="section.metaData as s">
          <td *ngFor="let j of s.measuresPerRow | fill">
            <ng-container *ngIf="i * j <= section.measures.length">
              <ng-container *ngIf="section.measures[(i * j) - 1] as measure">
                <!-- chords -->
                <table class="table table-compact">
                  <tr>
                    <td *ngFor="let k of s.beatsPerMeasure | fill">
                      <!-- only fill with text if there's a chord for this beat -->
                      <ng-container *ngIf="measure.chords.hasOwnProperty(k - 1)">
                        <ng-container *ngIf="measure.chords[k - 1] as chord">
                          {{ chord.note }}{{ chord.suffix }}
                        </ng-container>
                      </ng-container>
                    </td>
                  </tr>
                <!-- lyrics -->
                <tr *ngFor="let h of s.verseCount | fill">
                  <td [attr.colspan]="s.beatsPerMeasure">
                    <ng-container *ngIf="measure.lyrics.hasOwnProperty(h - 1)">
                      <ng-container *ngIf="measure.lyrics[h - 1] as lyric">
                        {{ lyric }}
                      </ng-container>
                    </ng-container>
                  </td>
                </tr>
                </table>
              </ng-container>
            </ng-container>
          </td>
        </ng-container>
      </tr>
    </table>
  </div>

</div>
