<!--
  Copyright (c) 2017 Bonnie Schulkin. All Rights Reserved.

  This file is part of BoxCharter.

  BoxCharter is free software: you can redistribute it and/or modify it under
  the terms of the GNU Affero General Public License as published by the Free
  Software Foundation, either version 3 of the License, or (at your option)
  any later version.

  BoxCharter is distributed in the hope that it will be useful, but WITHOUT
  ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
  FITNESS FOR A PARTICULAR PURPOSE. See the GNU Affero General Public License
  for more details.

  You should have received a copy of the GNU Affero General Public License
  along with BoxCharter. If not, see <http://www.gnu.org/licenses/>.
-->

<div *ngIf="chart">
  <h1>{{ chart.metaData.title }}</h1>

  <!-- sections -->
  <div *ngFor="let section of chart.sections">
    <ng-container *ngIf="section.metaData as s">
      <h2>{{ s.name }}</h2>
      <h5>{{ s.description }}</h5>
      <table class="table table-compact">
      <!-- measures -->
      <ng-container *ngFor="let measure of section.measures; let i=index">
        <ng-container *ngIf="i % s.measuresPerRow == 0">
          <tr>
        </ng-container>
        <td>
          <!-- chords -->
          <table class="table table-compact">
            <tr>
              <!-- one chord box per beat -->
              <td *ngFor="let j of s.beatsPerMeasure | fill">
                <input type="text" 
                       id="chord-{{j}}" 
                       value="{{ measure.chords.hasOwnProperty(j) ? 
                                measure.chords[j].note + 
                                  (measure.chords[j].suffix ? measure.chords[j].suffix : '') :
                                null }}" 
                       size="4" 
                       placeholder="/">
                </td>
              </tr>
            <!-- lyrics -->
            <tr *ngFor="let k of s.verseCount | fill">
              <td [attr.colspan]="s.beatsPerMeasure">
                <ng-container *ngIf="measure.lyrics.hasOwnProperty(k)">
                  <ng-container *ngIf="measure.lyrics[k] as lyric">
                    {{ lyric }}
                  </ng-container>
                </ng-container>
              </td>
            </tr>
            </table>
          </td>
        <ng-container *ngIf="i % s.measuresPerRow == s.measuresPerRow">
          <tr>
        </ng-container>
      </ng-container>
    </table>
    </ng-container>
  </div>
</div>
